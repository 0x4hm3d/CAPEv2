
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Per-Analysis Network Routing &#8212; CAPE Sandbox v2.1 Book</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/classic.css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Deploying CAPE in the Cloud" href="cloud.html" />
    <link rel="prev" title="Configuration" href="configuration.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="cloud.html" title="Deploying CAPE in the Cloud"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="configuration.html" title="Configuration"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">CAPE Sandbox v2.1 Book</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Installation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Preparing the Host</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Per-Analysis Network Routing</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="per-analysis-network-routing">
<span id="routing"></span><h1>Per-Analysis Network Routing<a class="headerlink" href="#per-analysis-network-routing" title="Permalink to this headline">¶</a></h1>
<p>With the more advanced per-analysis routing, it is naturally
also possible to have one default route - a setup that used to be popular
before, when the more luxurious routing was not yet available.</p>
<p>In our examples, we’ll be focusing on <code class="docutils literal notranslate"><span class="pre">KVM</span></code> as it is our default
machinery choice.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In case if you see proxy IP:PORT in networking for example as tor <cite>9040</cite> port.
It happens due that you have installed <cite>docker</cite> on your host and it breaks some networking filters.</p>
</div>
<p>To fix proxy IP:PORT problem, you need to run following script.
Save it to file, give execution permission with sudo a+x iptables_fix.sh and run it with proper arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!/bin/bash
# Fix when docker breaks your iptables
if [ $# -eq 0 ] || [ $# -lt 2 ]; then
    echo &quot;$0 &lt;netowrk range&gt; &lt;vir_iface&gt; &lt;real_iface&gt;&quot;
    echo &quot;    example: $0 192.168.1.0 virbr0 eno0&quot;
    exit 1
fi

echo &quot;[+] Setting iptables&quot;
iptables -t nat -A POSTROUTING -o &quot;$2&quot; -j MASQUERADE
iptables -A FORWARD -i &quot;$2&quot; -o &quot;$2&quot; -m state --state RELATED,ESTABLISHED -j ACCEPT
iptables -A FORWARD -i &quot;$2&quot; -o &quot;$2&quot; -j ACCEPT
iptables -I FORWARD -m physdev --physdev-is-bridged -j ACCEPT
iptables -I FORWARD -o &quot;$2&quot; -d  &quot;$1&quot;/24 -j ACCEPT
iptables -t nat -A POSTROUTING -s &quot;$1&quot;/24 -j MASQUERADE
iptables -A FORWARD -o &quot;$2&quot; -m state --state RELATED,ESTABLISHED -j ACCEPT
iptables -A FORWARD -i &quot;$2&quot; -o &quot;$3&quot; -j ACCEPT
iptables -A FORWARD -i &quot;$2&quot; -o lo -j ACCEPT

echo &quot;[+] Setting network options&quot;
# https://forums.fedoraforum.org/showthread.php?312824-Bridge-broken-after-docker-install&amp;s=ffc1c60cccc19e46c01b9a8e0fcd0c35&amp;p=1804899#post1804899
{
    echo &quot;net.bridge.bridge-nf-call-ip6tables=0&quot;;
    echo &quot;net.bridge.bridge-nf-call-iptables=0&quot;;
    echo &quot;net.bridge.bridge-nf-call-arptables=0&quot;;
    echo &quot;net.ipv4.conf.all.forwarding=1&quot;;
    echo &quot;net.ipv4.ip_forward=1&quot;;
} &gt;&gt; /etc/sysctl.conf
sysctl -p
echo &quot;iptables -A FORWARD -i $2 -o $2 -j ACCEPT&quot; &gt;&gt; /etc/network/if-pre-up.d/kvm_bridge_iptables

virsh nwfilter-list
</pre></div>
</div>
<p>To make it permanent you can use <cite>iptables-save</cite>.</p>
<section id="per-analysis-network-routing-options">
<h2>Per-Analysis Network Routing Options<a class="headerlink" href="#per-analysis-network-routing-options" title="Permalink to this headline">¶</a></h2>
<p>Following is the list of available routing options.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Routing Option</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#routing-none"><span class="std std-ref">None Routing</span></a></p></td>
<td><p>No routing whatsoever, the only option that does
<em>not</em> require the Rooter to be run (and
therefore also the <strong>default</strong> routing option).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#routing-drop"><span class="std std-ref">Drop Routing</span></a></p></td>
<td><p>Completely drops all non-CAPE traffic,
including traffic within the VMs’ subnet.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#routing-internet"><span class="std std-ref">Internet Routing</span></a></p></td>
<td><p>Full internet access as provided by the given
network interface (similar to the
<span class="xref std std-ref">simple_global_routing</span> setup).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#routing-inetsim"><span class="std std-ref">InetSim Routing</span></a></p></td>
<td><p>Routes all traffic to an InetSim instance -
which provides fake services - running on the
host machine.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#routing-tor"><span class="std std-ref">Tor Routing</span></a></p></td>
<td><p>Routes all traffic through Tor.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#routing-vpn"><span class="std std-ref">VPN Routing</span></a></p></td>
<td><p>Routes all traffic through one of perhaps
multiple pre-defined VPN endpoints.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#routing-socks"><span class="std std-ref">SOCKS Routing</span></a></p></td>
<td><p>Routes all traffic through one of perhaps
multiple pre-defined VPN endpoints.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="using-per-analysis-network-routing">
<h2>Using Per-Analysis Network Routing<a class="headerlink" href="#using-per-analysis-network-routing" title="Permalink to this headline">¶</a></h2>
<p>Now that you know the available network routing options, it is time to
use them in practice. Assuming CAPE has been configured properly
taking advantage of its features is as simple as <strong>starting the CAPE
Rooter and choosing a network routing option for your analysis</strong>.</p>
<p>Documentation on starting the <code class="docutils literal notranslate"><span class="pre">Rooter</span></code> may be found in the
<a class="reference internal" href="../../usage/rooter.html#cape-rooter-usage"><span class="std std-ref">CAPE Rooter Usage</span></a> document.</p>
<p>Both global routing and per-analysis routing require ip forwarding to be enabled:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ echo 1 | sudo tee -a /proc/sys/net/ipv4/ip_forward
$ sudo sysctl -w net.ipv4.ip_forward=1
</pre></div>
</div>
</section>
<section id="configuring-iproute2">
<span id="routing-iproute2"></span><h2>Configuring iproute2<a class="headerlink" href="#configuring-iproute2" title="Permalink to this headline">¶</a></h2>
<p>For Linux kernel TCP/IP source routing reasons it is required to register each
of the network interfaces that we use with <code class="docutils literal notranslate"><span class="pre">iproute2</span></code>. This is trivial but
necessary.</p>
<p>As an example we’ll be configuring <a class="reference internal" href="#routing-internet"><span class="std std-ref">Internet Routing</span></a> (aka the
<code class="docutils literal notranslate"><span class="pre">dirty</span> <span class="pre">line</span></code>) for which we’ll be using the <code class="docutils literal notranslate"><span class="pre">eth0</span></code> network interface -
reverting to Ubuntu 14.04 and older terminology here for a second (Ubuntu
16.04 uses network interface names based on the hardware manufacturer, as you
will likely have seen happen on BSD-based systems since forever).</p>
<p>To configure <code class="docutils literal notranslate"><span class="pre">iproute2</span></code> with <code class="docutils literal notranslate"><span class="pre">eth0</span></code> we’re going to open the
<code class="docutils literal notranslate"><span class="pre">/etc/iproute2/rt_tables</span></code> file which will look roughly as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># reserved values</span>
<span class="c1">#</span>
<span class="mi">255</span>     <span class="n">local</span>
<span class="mi">254</span>     <span class="n">main</span>
<span class="mi">253</span>     <span class="n">default</span>
<span class="mi">0</span>       <span class="n">unspec</span>
<span class="c1">#</span>
<span class="c1"># local</span>
<span class="c1">#</span>
</pre></div>
</div>
<p>Now roll a random number that is not yet present in this file with your dice
of choice and use it to craft a new line at the end of the file. As an
example, registering <code class="docutils literal notranslate"><span class="pre">eth0</span></code> with <code class="docutils literal notranslate"><span class="pre">iproute2</span></code> could look as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># reserved values</span>
<span class="c1">#</span>
<span class="mi">255</span>     <span class="n">local</span>
<span class="mi">254</span>     <span class="n">main</span>
<span class="mi">253</span>     <span class="n">default</span>
<span class="mi">0</span>       <span class="n">unspec</span>
<span class="c1">#</span>
<span class="c1"># local</span>
<span class="c1">#</span>

<span class="mi">400</span>     <span class="n">eth0</span>
</pre></div>
</div>
<p>And that’s all there is to it. You will have to do this for each
network interface you intend to use for network routing.</p>
<section id="none-routing">
<span id="routing-none"></span><h3>None Routing<a class="headerlink" href="#none-routing" title="Permalink to this headline">¶</a></h3>
<p>The default routing mechanism in the sense that CAPE allows the analysis to
route as defined by a third party. As in, it doesn’t do anything.
One may use the <code class="docutils literal notranslate"><span class="pre">none</span> <span class="pre">routing</span></code> in conjunction with the
<span class="xref std std-ref">simple_global_routing</span>.</p>
</section>
<section id="drop-routing">
<span id="routing-drop"></span><h3>Drop Routing<a class="headerlink" href="#drop-routing" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">drop</span> <span class="pre">routing</span></code> option is somewhat like a default <a class="reference internal" href="#routing-none"><span class="std std-ref">None Routing</span></a>
setup (as in, in a machine where no global <code class="docutils literal notranslate"><span class="pre">iptables</span></code> rules have been
created providing full internet access to VMs or so), except that it is much
more aggressive in actively locking down the internet access provided to the
VM.</p>
<p>With <code class="docutils literal notranslate"><span class="pre">drop</span> <span class="pre">routing</span></code> the only traffic possible is internal CAPE traffic and
hence any <code class="docutils literal notranslate"><span class="pre">DNS</span></code> requests or outgoing <code class="docutils literal notranslate"><span class="pre">TCP/IP</span></code> connections are blocked.</p>
</section>
<section id="internet-routing">
<span id="routing-internet"></span><h3>Internet Routing<a class="headerlink" href="#internet-routing" title="Permalink to this headline">¶</a></h3>
<p>By using the <code class="docutils literal notranslate"><span class="pre">internet</span> <span class="pre">routing</span></code> one may provide full internet access to VMs
through one of the connected network interfaces. We also refer to this option
as the <code class="docutils literal notranslate"><span class="pre">dirty</span> <span class="pre">line</span></code> due to its nature of allowing all potentially malicious
samples to connect to the internet through the same uplink.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is required to register the dirty line network interface with
iproute2 as described in the <a class="reference internal" href="#routing-iproute2"><span class="std std-ref">Configuring iproute2</span></a> section.</p>
</div>
</section>
<section id="inetsim-routing">
<span id="routing-inetsim"></span><h3>InetSim Routing<a class="headerlink" href="#inetsim-routing" title="Permalink to this headline">¶</a></h3>
<p>For those that have not heard of <a class="reference external" href="http://www.inetsim.org/">InetSim</a>, it’s a project that provides
fake services for malware to talk to. To use <code class="docutils literal notranslate"><span class="pre">InetSim</span> <span class="pre">routing</span></code> one
will have to set up InetSim on the host machine (or in a separate VM) and
configure CAPE so that it knows where to find the InetSim server.</p>
<p>The configuration for InetSim is self-explanatory and can be found as part
of the <code class="docutils literal notranslate"><span class="pre">$CWD/conf/routing.conf</span></code> configuration file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">inetsim</span><span class="p">]</span>
<span class="n">enabled</span> <span class="o">=</span> <span class="n">yes</span>
<span class="n">server</span> <span class="o">=</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">122.1</span>
</pre></div>
</div>
<p>To quickly get started with InetSim it is possible to download
the latest version of the <a class="reference external" href="https://remnux.org/">REMnux</a> distribution which features - among many
other tools - the latest version of InetSim. Naturally, this VM will
require a static IP address which should then be configured in the
<code class="docutils literal notranslate"><span class="pre">routing.conf</span></code> configuration file.</p>
<p>We <code class="docutils literal notranslate"><span class="pre">suggest</span> <span class="pre">running</span> <span class="pre">it</span> <span class="pre">on</span> <span class="pre">a</span> <span class="pre">virtual</span> <span class="pre">machine</span></code> to avoid any possible leaks</p>
</section>
<section id="tor-routing">
<span id="routing-tor"></span><h3>Tor Routing<a class="headerlink" href="#tor-routing" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although we <strong>highly discourage</strong> the use of Tor for malware analysis
- the maintainers of <code class="docutils literal notranslate"><span class="pre">Tor</span> <span class="pre">exit</span> <span class="pre">nodes</span></code> already have a hard enough time
keeping up their servers - it is a well-supported feature.</p>
</div>
<p>First of all, Tor will have to be installed. Please find instructions on
installing the <a class="reference external" href="https://www.torproject.org/docs/debian.html.en">latest stable version of Tor here</a>.</p>
<p>We’ll then have to modify the <code class="docutils literal notranslate"><span class="pre">Tor</span></code> configuration file (not talking about
CAPE’s configuration for Tor yet!) To do so, we will have to
provide Tor with the listening address and port for TCP/IP connections and UDP
requests. For a default <code class="docutils literal notranslate"><span class="pre">KVM</span></code> setup, where the host machine has IP
address <code class="docutils literal notranslate"><span class="pre">192.168.122.1</span></code>, the following lines will have to be configured in
the <code class="docutils literal notranslate"><span class="pre">/etc/tor/torrc</span></code> file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TransPort</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">122.1</span><span class="p">:</span><span class="mi">9040</span>
<span class="n">DNSPort</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">122.1</span><span class="p">:</span><span class="mi">5353</span>
</pre></div>
</div>
<p>Don’t forget to restart Tor (<code class="docutils literal notranslate"><span class="pre">/etc/init.d/tor</span> <span class="pre">restart</span></code>). That leaves us with
the Tor configuration for Cuckoo, which may be found in the
<code class="docutils literal notranslate"><span class="pre">$CWD/conf/routing.conf</span></code> file. The configuration is pretty self-explanatory
so we’ll leave filling it out as an exercise to the reader (in fact, toggling
the <code class="docutils literal notranslate"><span class="pre">enabled</span></code> field goes a long way):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">tor</span><span class="p">]</span>
<span class="n">enabled</span> <span class="o">=</span> <span class="n">yes</span>
<span class="n">dnsport</span> <span class="o">=</span> <span class="mi">5353</span>
<span class="n">proxyport</span> <span class="o">=</span> <span class="mi">9040</span>
</pre></div>
</div>
<p>Note that the port numbers in the <code class="docutils literal notranslate"><span class="pre">/etc/tor/torrc</span></code> and
<code class="docutils literal notranslate"><span class="pre">$CWD/conf/routing.conf</span></code> files must match for the two to interact
correctly.</p>
</section>
<section id="vpn-routing">
<span id="routing-vpn"></span><h3>VPN Routing<a class="headerlink" href="#vpn-routing" title="Permalink to this headline">¶</a></h3>
<p>It is possible to route analyses through multiple VPNs.
By defining a couple of VPNs, perhaps ending up in different countries, it may
be possible to see if potentially malicious samples behave differently
depending on the country of origin of their IP address.</p>
<p>The configuration for a VPN is much like the configuration of a VM. For each
VPN you will need one section in the <code class="docutils literal notranslate"><span class="pre">$CWD/conf/routing.conf</span></code> configuration
file detailing the relevant information for the VPN. In the configuration, the
VPN will also have to be <em>registered</em> in the list of available VPNs
(the same as you’d do for registering more VMs).</p>
<p>Configuration for a single VPN looks roughly as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">vpn</span><span class="p">]</span>
<span class="c1"># Are VPNs enabled?</span>
<span class="n">enabled</span> <span class="o">=</span> <span class="n">yes</span>

<span class="c1"># Comma-separated list of the available VPNs.</span>
<span class="n">vpns</span> <span class="o">=</span> <span class="n">vpn0</span>

<span class="p">[</span><span class="n">vpn0</span><span class="p">]</span>
<span class="c1"># Name of this VPN. The name is represented by the filepath to the</span>
<span class="c1"># configuration file, e.g., CAPE would represent /etc/openvpn/cuckoo.conf</span>
<span class="c1"># Note that you can&#39;t assign the names &quot;none&quot; and &quot;internet&quot; as those would</span>
<span class="c1"># conflict with the routing section in cuckoo.conf.</span>
<span class="n">name</span> <span class="o">=</span> <span class="n">vpn0</span>

<span class="c1"># The description of this VPN which will be displayed in the web interface.</span>
<span class="c1"># Can be used to for example describe the country where this VPN ends up.</span>
<span class="n">description</span> <span class="o">=</span> <span class="n">Spain</span><span class="p">,</span> <span class="n">Europe</span>

<span class="c1"># The tun device hardcoded for this VPN. Each VPN *must* be configured to use</span>
<span class="c1"># a hardcoded/persistent tun device by explicitly adding the line &quot;dev tunX&quot;</span>
<span class="c1"># to its configuration (e.g., /etc/openvpn/vpn1.conf) where X in tunX is a</span>
<span class="c1"># unique number between 0 and your lucky number of choice.</span>
<span class="n">interface</span> <span class="o">=</span> <span class="n">tun0</span>

<span class="c1"># Routing table name/id for this VPN. If table name is used it *must* be</span>
<span class="c1"># added to /etc/iproute2/rt_tables as &quot;&lt;id&gt; &lt;name&gt;&quot; line (e.g., &quot;201 tun0&quot;).</span>
<span class="c1"># ID and name must be unique across the system (refer /etc/iproute2/rt_tables</span>
<span class="c1"># for existing names and IDs).</span>
<span class="n">rt_table</span> <span class="o">=</span> <span class="n">tun0</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is required to register each VPN network interface with iproute2
as described in the <a class="reference internal" href="#routing-iproute2"><span class="std std-ref">Configuring iproute2</span></a> section.</p>
</div>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/kevoreilly/CAPEv2/blob/master/utils/vpn2cape.py">Helper script, read code to understand it</a></p></li>
<li><p><a class="reference external" href="https://musings.konundrum.org/2020/12/12/wireguard-and-cape.html">Example of wireguard integration</a></p></li>
</ul>
<p>VPN persistence &amp; auto-restart <a class="reference external" href="https://www.ivpn.net/knowledgebase/linux/linux-autostart-openvpn-in-systemd-ubuntu/">source</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. Run the command:
    # sudo nano /etc/default/openvpn`
    and uncomment, or remove, the “#” in front of AUTOSTART=&quot;all&quot;
    then press ‘Ctrl X’ to save the changes and exit the text editor.

2. Move the .ovpn file with the desired server location to the ‘/etc/openvpn’ folder:
    # sudo cp /location/whereYouDownloadedConfigfilesTo/Germany.ovpn /etc/openvpn/

3. In the ‘/etc/openvpn’ folder, create a text file called login.creds:
    # sudo nano /etc/openvpn/login.creds
    and enter your IVPN Account ID (starts with ‘ivpn’) on the first line and any non-blank text on the 2nd line, then press ‘Ctrl X’ to save the changes and exit the text editor.

4. Change the permissions on the pass file to protect the credentials:
    # sudo chmod 400 /etc/openvpn/login.creds

5. Rename the .ovpn file to ‘client.conf’:
    # sudo cp /etc/openvpn/Germany.ovpn /etc/openvpn/client.conf

6. Reload the daemons:
# sudo systemctl daemon-reload

1. Start the OpenVPN service:
    # sudo systemctl start openvpn

2. Test if it is working by checking the external IP:
    # curl ifconfig.co

3. If curl is not installed:
    # sudo apt install curl
</pre></div>
</div>
</section>
<section id="socks-routing">
<span id="routing-socks"></span><h3>SOCKS Routing<a class="headerlink" href="#socks-routing" title="Permalink to this headline">¶</a></h3>
<p>You also can use socks proxy servers to route your traffic.
To manage your socks server you can use Socks5man software.
Building them by yourself, using your favorite software, bying, etc
The configuration is pretty simple and looks like VPN, but you don’t need to configure anything else</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">socks5</span><span class="p">]</span>
<span class="c1"># By default we disable socks5 support as it requires running utils/rooter.py as</span>
<span class="c1"># root next to cuckoo.py (which should run as regular user).</span>
<span class="n">enabled</span> <span class="o">=</span> <span class="n">no</span>

<span class="c1"># Comma-separated list of the available proxies.</span>
<span class="n">proxies</span> <span class="o">=</span> <span class="n">socks_CC</span>

<span class="p">[</span><span class="n">socks_CC</span><span class="p">]</span>
<span class="n">name</span> <span class="o">=</span> <span class="n">CC_socks</span>
<span class="n">description</span> <span class="o">=</span> <span class="n">CC_socks</span>
<span class="n">proxyport</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">dnsport</span> <span class="o">=</span> <span class="mi">10000</span>
</pre></div>
</div>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/cape.png" alt="Logo"/>
            </a></p>
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Per-Analysis Network Routing</a><ul>
<li><a class="reference internal" href="#per-analysis-network-routing-options">Per-Analysis Network Routing Options</a></li>
<li><a class="reference internal" href="#using-per-analysis-network-routing">Using Per-Analysis Network Routing</a></li>
<li><a class="reference internal" href="#configuring-iproute2">Configuring iproute2</a><ul>
<li><a class="reference internal" href="#none-routing">None Routing</a></li>
<li><a class="reference internal" href="#drop-routing">Drop Routing</a></li>
<li><a class="reference internal" href="#internet-routing">Internet Routing</a></li>
<li><a class="reference internal" href="#inetsim-routing">InetSim Routing</a></li>
<li><a class="reference internal" href="#tor-routing">Tor Routing</a></li>
<li><a class="reference internal" href="#vpn-routing">VPN Routing</a></li>
<li><a class="reference internal" href="#socks-routing">SOCKS Routing</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="configuration.html"
                          title="previous chapter">Configuration</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="cloud.html"
                          title="next chapter">Deploying CAPE in the Cloud</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/installation/host/routing.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="cloud.html" title="Deploying CAPE in the Cloud"
             >next</a></li>
        <li class="right" >
          <a href="configuration.html" title="Configuration"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">CAPE Sandbox v2.1 Book</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Installation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Preparing the Host</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Per-Analysis Network Routing</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2010-2015, Cuckoo Foundation, 2016-2020, kevoreilly.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
    </div>
  </body>
</html>