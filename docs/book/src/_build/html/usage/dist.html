
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Distributed CAPE &#8212; CAPE Sandbox v2.1 Book</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Analysis Packages" href="packages.html" />
    <link rel="prev" title="REST API" href="api.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="packages.html" title="Analysis Packages"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="api.html" title="REST API"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">CAPE Sandbox v2.1 Book</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Usage</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Distributed CAPE</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="distributed-cape">
<h1>Distributed CAPE<a class="headerlink" href="#distributed-cape" title="Permalink to this headline">¶</a></h1>
<p>This works under the main server web interface, so everything is transparent for the end user, even if they were analyzed on another server(s).</p>
<p>Deploy each server as a normal server and later just register it as a worker on the master server where dist.py is running.</p>
<section id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h2>
<p>The distributed script uses a few Python libraries which can be installed
through the following command (on Debian/Ubuntu):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo pip3 install flask flask-restful flask-sqlalchemy requests
</pre></div>
</div>
</section>
<section id="starting-the-distributed-rest-api">
<h2>Starting the Distributed REST API<a class="headerlink" href="#starting-the-distributed-rest-api" title="Permalink to this headline">¶</a></h2>
<p>The Distributed REST API requires a few commandline options in order to run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cd /opt/CAPEv2/web &amp;&amp; python3 manage.py runserver_plus 0.0.0.0:8000 --traceback --keep-meta-shutdown
</pre></div>
</div>
</section>
<section id="restful-resources">
<h2>RESTful resources<a class="headerlink" href="#restful-resources" title="Permalink to this headline">¶</a></h2>
<p>Following are all RESTful resources. Also, make sure to check out the
<a class="reference internal" href="#quick-usage"><span class="std std-ref">Quick usage</span></a> section which documents the most commonly used commands.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 36%" />
<col style="width: 64%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Resource</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">GET</span></code> <a class="reference internal" href="#node-root-get"><span class="std std-ref">GET /node</span></a></p></td>
<td><p>Get a list of all enabled CAPE nodes  .</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">POST</span></code> <a class="reference internal" href="#node-root-post"><span class="std std-ref">POST /node</span></a></p></td>
<td><p>Register a new CAPE node.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">GET</span></code> <a class="reference internal" href="#node-get"><span class="std std-ref">GET /node/&lt;name&gt;</span></a></p></td>
<td><p>Get basic information about a node.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">PUT</span></code> <a class="reference internal" href="#node-put"><span class="std std-ref">PUT /node/&lt;name&gt;</span></a></p></td>
<td><p>Update basic information of a node.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DELETE</span></code> <a class="reference internal" href="#node-delete"><span class="std std-ref">DELETE /node/&lt;name&gt;</span></a></p></td>
<td><p>Disable (not completely remove!) a node.</p></td>
</tr>
</tbody>
</table>
<section id="get-node">
<span id="node-root-get"></span><h3>GET /node<a class="headerlink" href="#get-node" title="Permalink to this headline">¶</a></h3>
<p>Returns all enabled nodes. For each node its associated name, API url, and
machines are returned:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl http://localhost:9003/node
{
    &quot;nodes&quot;: {
        &quot;localhost&quot;: {
            &quot;machines&quot;: [
                {
                    &quot;name&quot;: &quot;cuckoo1&quot;,
                    &quot;platform&quot;: &quot;windows&quot;,
                    &quot;tags&quot;: [
                        &quot;&quot;
                    ]
                }
            ],
            &quot;name&quot;: &quot;localhost&quot;,
            &quot;url&quot;: &quot;http://0:8000/apiv2/&quot;
        }
    }
}
</pre></div>
</div>
</section>
<section id="post-node">
<span id="node-root-post"></span><h3>POST /node<a class="headerlink" href="#post-node" title="Permalink to this headline">¶</a></h3>
<p>Register a new CAPE node by providing the name and the URL. Optionally the apikey if auth is enabled,
You might need to enable <code class="docutils literal notranslate"><span class="pre">list_exitnodes</span></code> and <code class="docutils literal notranslate"><span class="pre">machinelist</span></code> in <code class="docutils literal notranslate"><span class="pre">conf/api.conf</span></code>
if your Node API is behing htaccess authentication:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl http://localhost:9003/node -F name=master -F url=http://localhost:8000/apiv2/ -F apikey=apikey
{
    &quot;machines&quot;: [
        {
            &quot;name&quot;: &quot;cape1&quot;,
            &quot;platform&quot;: &quot;windows&quot;,
            &quot;tags&quot;: []
        }
    ],
    &quot;name&quot;: &quot;localhost&quot;
}
</pre></div>
</div>
</section>
<section id="get-node-name">
<span id="node-get"></span><h3>GET /node/&lt;name&gt;<a class="headerlink" href="#get-node-name" title="Permalink to this headline">¶</a></h3>
<p>Get basic information about a particular CAPE node:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl http://localhost:9003/node/localhost
{
    &quot;name&quot;: &quot;localhost&quot;,
    &quot;url&quot;: &quot;http://localhost:8000/apiv2/&quot;
}
</pre></div>
</div>
</section>
<section id="put-node-name">
<span id="node-put"></span><h3>PUT /node/&lt;name&gt;<a class="headerlink" href="#put-node-name" title="Permalink to this headline">¶</a></h3>
<p>Update basic information of a CAPE node:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl -XPUT http://localhost:9003/node/localhost -F name=newhost \
    -F url=http://1.2.3.4:8000/apiv2/
null

Additional Arguments:

* enabled
    False=0 or True=1 to activate or deactivate worker node
* exitnodes
    exitnodes=1 - Update exit nodes list, to show on main webgui
* apikey
    apikey for authorization
</pre></div>
</div>
</section>
<section id="delete-node-name">
<span id="node-delete"></span><h3>DELETE /node/&lt;name&gt;<a class="headerlink" href="#delete-node-name" title="Permalink to this headline">¶</a></h3>
<p>Disable a CAPE node, therefore not having it process any new tasks, but
keep its history in the Distributed’s database:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl -XDELETE http://localhost:9003/node/localhost
null
</pre></div>
</div>
</section>
</section>
<section id="quick-usage">
<span id="id1"></span><h2>Quick usage<a class="headerlink" href="#quick-usage" title="Permalink to this headline">¶</a></h2>
<p>For practical usage the following few commands will be most interesting.</p>
<p>Register a CAPE node - a CAPE REST API running on the same machine in this
case:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl http://localhost:9003/node -F name=master -F url=http://localhost:8000/apiv2/
Master server must be called master, the rest of names we don&#39;t care
</pre></div>
</div>
<p>Disable a CAPE node:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl -XDELETE http://localhost:9003/node/&lt;name&gt;
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl -XPUT http://localhost:9003/node/localhost -F enable=0
null
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./dist.py --node NAME --disable
</pre></div>
</div>
<dl class="simple">
<dt>Submit a new analysis task</dt><dd><p>The method of submission is always the same: by REST API or via web GUI, both only pointing to the “master node”.</p>
</dd>
</dl>
<p>Get the report of a task should be requested throw master node integrated /api/</p>
</section>
<section id="proposed-setup">
<h2>Proposed setup<a class="headerlink" href="#proposed-setup" title="Permalink to this headline">¶</a></h2>
<p>The following description depicts a Distributed CAPE setup with two CAPE
machines, a <strong>master</strong> and a <strong>worker</strong>. In this setup the first machine,
the master, also hosts the Distributed CAPE REST API.</p>
<section id="configuration-settings">
<h3>Configuration settings<a class="headerlink" href="#configuration-settings" title="Permalink to this headline">¶</a></h3>
<p>Our setup will require a couple of updates about the configuration
files.</p>
<p>Note about VMs tags in hypervisor conf as kvm.conf:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">If</span> <span class="n">you</span> <span class="n">have</span> <span class="o">**</span><span class="n">x64</span><span class="o">**</span> <span class="ow">and</span> <span class="o">**</span><span class="n">x86</span><span class="o">**</span> <span class="n">VMs</span><span class="p">:</span>
<span class="o">*</span> <span class="o">**</span><span class="n">x64</span><span class="o">**</span> <span class="n">VMs</span> <span class="n">should</span> <span class="n">have</span> <span class="n">both</span> <span class="o">**</span><span class="n">x64</span><span class="o">**</span> <span class="ow">and</span> <span class="o">**</span><span class="n">x86</span><span class="o">**</span> <span class="n">tags</span><span class="o">.</span> <span class="n">Otherwise</span> <span class="n">only</span> <span class="o">**</span><span class="n">x64</span><span class="o">**</span> <span class="n">tag</span>
<span class="o">*</span> <span class="o">**</span><span class="n">x86</span><span class="o">**</span> <span class="n">VMs</span> <span class="n">should</span> <span class="n">have</span> <span class="n">only</span> <span class="o">**</span><span class="n">x86</span><span class="o">**</span> <span class="n">tag</span><span class="o">.</span>
<span class="o">*</span> <span class="n">You</span> <span class="n">can</span> <span class="n">use</span> <span class="nb">any</span> <span class="n">other</span> <span class="n">tags</span><span class="p">,</span> <span class="n">just</span> <span class="n">to</span> <span class="n">work</span> <span class="n">properly</span> <span class="n">you</span> <span class="n">need</span> <span class="n">those</span> <span class="n">two</span><span class="o">.</span>
<span class="o">*</span> <span class="n">Probably</span> <span class="n">will</span> <span class="n">be</span> <span class="n">improved</span> <span class="ow">in</span> <span class="n">future</span> <span class="k">for</span> <span class="n">better</span> <span class="n">solution</span>
</pre></div>
</div>
<section id="conf-cuckoo-conf">
<h4>conf/cuckoo.conf<a class="headerlink" href="#conf-cuckoo-conf" title="Permalink to this headline">¶</a></h4>
<p>Update <code class="docutils literal notranslate"><span class="pre">process_results</span></code> to <code class="docutils literal notranslate"><span class="pre">off</span></code> as we will be running our results
processing script (for performance reasons).</p>
<p>Update <code class="docutils literal notranslate"><span class="pre">tmppath</span></code> to something that holds enough storage to store a few
hundred binaries. On some servers or setups <code class="docutils literal notranslate"><span class="pre">/tmp</span></code> may have a limited amount
of space and thus this wouldn’t suffice.</p>
<p>Update <code class="docutils literal notranslate"><span class="pre">connection</span></code> to use something that is <em>not</em> sqlite3. Preferably PostgreSQL or
MySQL. SQLite3 doesn’t support multi-threaded applications that well and this
will give errors at random if used.</p>
</section>
<section id="conf-processing-conf">
<h4>conf/processing.conf<a class="headerlink" href="#conf-processing-conf" title="Permalink to this headline">¶</a></h4>
<p>You may want to disable some processing modules, such as <code class="docutils literal notranslate"><span class="pre">virustotal</span></code>.</p>
</section>
<section id="conf-reporting-conf">
<h4>conf/reporting.conf<a class="headerlink" href="#conf-reporting-conf" title="Permalink to this headline">¶</a></h4>
<p>Depending on which report(s) are required for integration with your system it
might make sense to only make those report(s) that you’re going to use. Thus
disable the other ones.</p>
<p>Check also “[distributed]” section, where you can set the database, path for samples,
and a few more values.
<em>Do not</em> use sqlite3! Use PostgreSQL database for performance and thread safe.</p>
</section>
</section>
<section id="register-cape-nodes">
<h3>Register CAPE nodes<a class="headerlink" href="#register-cape-nodes" title="Permalink to this headline">¶</a></h3>
<p>As outlined in <a class="reference internal" href="#quick-usage"><span class="std std-ref">Quick usage</span></a> the CAPE nodes have to be registered with
the Distributed CAPE script:</p>
<p>without htaccess:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl http://localhost:9003/node -F name=master -F url=http://localhost:8000/apiv2/
</pre></div>
</div>
<p>with htaccess:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl http://localhost:9003/node -F name=worker -F url=http://1.2.3.4:8000/apiv2/ \
  -F username=user -F password=password
</pre></div>
</div>
<p>Having registered the CAPE nodes all that’s left to do now is to submit
tasks and fetch reports once finished. Documentation on these commands can be
found in the <a class="reference internal" href="#quick-usage"><span class="std std-ref">Quick usage</span></a> section.</p>
</section>
<section id="vm-maintenance">
<h3>VM Maintenance<a class="headerlink" href="#vm-maintenance" title="Permalink to this headline">¶</a></h3>
<p>Occasionally you might want to perform maintenance on VMs without shutting down your whole node.
To do this, you need to remove the VM from being used by CAPE in its execution, preferably without
having to restart the <code class="docutils literal notranslate"><span class="pre">./cuckoo.py</span></code> daemon.</p>
<p>First, get a list of available VMs that are running on the worker:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./dist.py --node NAME
</pre></div>
</div>
<p>Secondly, you can remove VMs from being used by CAPE with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./dist.py --node NAME --delete-vm VM_NAME
</pre></div>
</div>
<p>When you are done editing your VMs you need to add them back to be used by <code class="docutils literal notranslate"><span class="pre">cuckoo</span></code>. The easiest
way to do that is to disable the node, so no more tasks get submitted to it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./dist.py --node NAME --disable
</pre></div>
</div>
<p>Wait for all running VMs to finish their tasks, and then restart the workers <code class="docutils literal notranslate"><span class="pre">./cuckoo.py</span></code>, this will
re-insert the previously deleted VMs into the Database from <code class="docutils literal notranslate"><span class="pre">conf/virtualbox.conf</span></code>.</p>
<p>Update the VM list on the master:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./dist.py --node NAME
</pre></div>
</div>
<p>And enable the worker again:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./dist.py --node NAME --enable
</pre></div>
</div>
</section>
<section id="good-practice-for-production">
<h3>Good practice for production<a class="headerlink" href="#good-practice-for-production" title="Permalink to this headline">¶</a></h3>
<p>The number of retrieved threads can be configured in reporting.conf</p>
<p>Installation of “uwsgi”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># nginx is optional</span>
<span class="c1"># apt-get install uwsgi uwsgi-plugin-python3 nginx</span>
</pre></div>
</div>
<p>It’s better if you run “web” and “dist.py” as uwsgi application</p>
<p>uwsgi config for dist.py - Found at <code class="docutils literal notranslate"><span class="pre">/opt/CAPE/uwsgi/capedist.ini</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">uwsgi</span><span class="p">]</span>
<span class="p">;</span> <span class="n">you</span> <span class="n">might</span> <span class="n">need</span> <span class="n">to</span> <span class="n">adjust</span> <span class="n">plugin</span><span class="o">-</span><span class="nb">dir</span> <span class="n">path</span> <span class="k">for</span> <span class="n">your</span> <span class="n">system</span>
<span class="p">;</span> <span class="n">plugins</span><span class="o">-</span><span class="nb">dir</span> <span class="o">=</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">uwsgi</span><span class="o">/</span><span class="n">plugins</span>
<span class="n">plugins</span> <span class="o">=</span> <span class="n">python38</span>
<span class="n">callable</span> <span class="o">=</span> <span class="n">app</span>
<span class="p">;</span> <span class="n">For</span> <span class="n">venvs</span> <span class="n">see</span> <span class="o">-</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">uwsgi</span><span class="o">-</span><span class="n">docs</span><span class="o">.</span><span class="n">readthedocs</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">en</span><span class="o">/</span><span class="n">latest</span><span class="o">/</span><span class="n">Python</span><span class="o">.</span><span class="n">html</span><span class="c1">#virtualenv-support</span>
<span class="p">;</span> <span class="n">virtualenv</span> <span class="o">=</span> <span class="n">path_to_venv</span>
<span class="p">;</span><span class="n">change</span> <span class="n">this</span> <span class="n">patch</span> <span class="k">if</span> <span class="ow">is</span> <span class="n">different</span>
<span class="n">chdir</span> <span class="o">=</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">CAPEv2</span><span class="o">/</span><span class="n">utils</span>
<span class="n">master</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">mount</span> <span class="o">=</span> <span class="o">/=</span><span class="n">dist</span><span class="o">.</span><span class="n">py</span>
<span class="n">threads</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">workers</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">manage</span><span class="o">-</span><span class="n">script</span><span class="o">-</span><span class="n">name</span> <span class="o">=</span> <span class="n">true</span>
<span class="p">;</span> <span class="k">if</span> <span class="n">you</span> <span class="n">will</span> <span class="n">use</span> <span class="k">with</span> <span class="n">nginx</span><span class="p">,</span> <span class="n">comment</span> <span class="nb">next</span> <span class="n">line</span>
<span class="n">socket</span> <span class="o">=</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">9003</span>
<span class="n">safe</span><span class="o">-</span><span class="n">pidfile</span> <span class="o">=</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">dist</span><span class="o">.</span><span class="n">pid</span>
<span class="n">protocol</span><span class="o">=</span><span class="n">http</span>
<span class="n">enable</span><span class="o">-</span><span class="n">threads</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">lazy</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">lazy</span><span class="o">-</span><span class="n">apps</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">timeout</span> <span class="o">=</span> <span class="mi">600</span>
<span class="n">chmod</span><span class="o">-</span><span class="n">socket</span> <span class="o">=</span> <span class="mi">664</span>
<span class="n">chown</span><span class="o">-</span><span class="n">socket</span> <span class="o">=</span> <span class="n">cape</span><span class="p">:</span><span class="n">cape</span>
<span class="n">gui</span> <span class="o">=</span> <span class="n">cape</span>
<span class="n">uid</span> <span class="o">=</span> <span class="n">cape</span>
<span class="n">harakiri</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">hunder</span><span class="o">-</span><span class="n">lock</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">stats</span> <span class="o">=</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">9191</span>
</pre></div>
</div>
<p>To run your api with config just execute as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># WEBGUI is started by systemd as cape-web.service
$ uwsgi --ini /opt/CAPEv2/uwsgi/capedist.ini
</pre></div>
</div>
<p>To add your application to auto start after boot, copy your config file to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cp</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">CAPEv2</span><span class="o">/</span><span class="n">uwsgi</span><span class="o">/</span><span class="n">capedist</span><span class="o">.</span><span class="n">ini</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">uwsgi</span><span class="o">/</span><span class="n">apps</span><span class="o">-</span><span class="n">available</span><span class="o">/</span><span class="n">cape_dist</span><span class="o">.</span><span class="n">ini</span>
<span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">uwsgi</span><span class="o">/</span><span class="n">apps</span><span class="o">-</span><span class="n">available</span><span class="o">/</span><span class="n">cape_dist</span><span class="o">.</span><span class="n">ini</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">uwsgi</span><span class="o">/</span><span class="n">apps</span><span class="o">-</span><span class="n">enabled</span>

<span class="n">service</span> <span class="n">uwsgi</span> <span class="n">restart</span>
</pre></div>
</div>
<p>Optimizations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">If</span> <span class="n">you</span> <span class="n">have</span> <span class="n">many</span> <span class="n">workers</span> <span class="ow">is</span> <span class="n">recommended</span>
    <span class="n">UWSGI</span><span class="p">:</span>
        <span class="nb">set</span> <span class="n">processes</span> <span class="n">to</span> <span class="n">be</span> <span class="n">able</span> <span class="n">handle</span> <span class="n">number</span> <span class="n">of</span> <span class="n">requests</span> <span class="n">dist</span> <span class="o">+</span> <span class="n">dist2</span> <span class="o">+</span> <span class="mi">10</span>
    <span class="n">DB</span><span class="p">:</span>
        <span class="nb">set</span> <span class="nb">max</span> <span class="n">connection</span> <span class="n">number</span> <span class="n">to</span> <span class="n">be</span> <span class="n">able</span> <span class="n">handle</span> <span class="n">number</span> <span class="n">of</span> <span class="n">requests</span> <span class="n">dist</span> <span class="o">+</span> <span class="n">dist2</span> <span class="o">+</span> <span class="mi">10</span>
</pre></div>
</div>
<p>Distributed Mongo setup:</p>
<p>Set one mongo as master and the rest just point to it, in this example cuckoo_dist.fe is our master server.
Depending on your hardware you may prepend the next command before mongod</p>
<blockquote>
<div><p>$ numactl –interleave=all</p>
</div></blockquote>
<dl>
<dt>This execute on all nodes, master included:</dt><dd><ul class="simple">
<li><p>Very important, before the creation or recreation of the cluster, all /data should be removed to avoid problems with metadata</p></li>
</ul>
<p>$ mkdir -p /data/{config,}db</p>
</dd>
</dl>
<p>These commands should be executed only on the master:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># create config server instance with the &quot;cuckoo_config&quot; replica set</span>
<span class="c1"># Preferly to execute few config servers on different shards</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">mongod</span> <span class="o">--</span><span class="n">configsvr</span> <span class="o">--</span><span class="n">replSet</span> <span class="n">cuckoo_config</span> <span class="o">--</span><span class="n">bind_ip_all</span>

<span class="c1"># initialize the &quot;cuckoo_config&quot; replica set</span>
<span class="n">mongosh</span> <span class="o">--</span><span class="n">port</span> <span class="mi">27019</span>

<span class="n">Execute</span> <span class="ow">in</span> <span class="n">mongo</span> <span class="n">console</span><span class="p">:</span>
    <span class="n">rs</span><span class="o">.</span><span class="n">initiate</span><span class="p">({</span>
      <span class="n">_id</span><span class="p">:</span> <span class="s2">&quot;cuckoo_config&quot;</span><span class="p">,</span>
      <span class="n">configsvr</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="n">members</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="n">_id</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="s2">&quot;192.168.1.13:27019&quot;</span> <span class="p">},</span>
      <span class="p">]</span>
    <span class="p">})</span>
</pre></div>
</div>
<p>This should be started on all nodes including master:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># start shard server</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">mongod</span> <span class="o">--</span><span class="n">shardsvr</span> <span class="o">--</span><span class="n">bind_ip</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span> <span class="o">--</span><span class="n">port</span> <span class="mi">27017</span> <span class="o">--</span><span class="n">replSet</span> <span class="n">rs0</span>
</pre></div>
</div>
<p>Add clients, execute on master mongo server:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># start mongodb router instance that connects to the config server</span>
<span class="n">mongos</span> <span class="o">--</span><span class="n">configdb</span> <span class="n">cuckoo_config</span><span class="o">/</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">1.13</span><span class="p">:</span><span class="mi">27019</span> <span class="o">--</span><span class="n">port</span> <span class="mi">27020</span> <span class="o">--</span><span class="n">bind_ip_all</span>

<span class="c1"># in another terminal</span>
<span class="n">mongosh</span>
<span class="n">rs</span><span class="o">.</span><span class="n">initiate</span><span class="p">(</span> <span class="p">{</span>
   <span class="n">_id</span> <span class="p">:</span> <span class="s2">&quot;rs0&quot;</span><span class="p">,</span>
   <span class="n">members</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span> <span class="n">_id</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="s2">&quot;192.168.1.x:27017&quot;</span> <span class="p">},</span>
      <span class="p">{</span> <span class="n">_id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="s2">&quot;192.168.1.x:27017&quot;</span> <span class="p">},</span>
      <span class="p">{</span> <span class="n">_id</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="s2">&quot;192.168.1.x:27017&quot;</span> <span class="p">},</span>
   <span class="p">]</span>
<span class="p">})</span>

<span class="c1"># Check which node is primary and change the prior if is incorrect</span>
<span class="c1"># https://docs.mongodb.com/manual/tutorial/force-member-to-be-primary/</span>
<span class="n">cfg</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">conf</span><span class="p">()</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">members</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">priority</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">members</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">priority</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">members</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">priority</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">rs</span><span class="o">.</span><span class="n">reconfig</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;force&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">})</span>

<span class="c1"># Add arbiter only</span>
<span class="n">rs</span><span class="o">.</span><span class="n">addArb</span><span class="p">(</span><span class="s2">&quot;192.168.1.51:27017&quot;</span><span class="p">)</span>

<span class="c1"># Add replica set member, secondary</span>
<span class="n">rs</span><span class="o">.</span><span class="n">add</span><span class="p">({</span><span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;192.168.1.50:27017&quot;</span><span class="p">,</span> <span class="s2">&quot;priority&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">})</span>

<span class="c1"># add shards</span>
<span class="n">mongosh</span> <span class="o">--</span><span class="n">port</span> <span class="mi">27020</span>

<span class="n">Execute</span> <span class="ow">in</span> <span class="n">mongo</span> <span class="n">console</span><span class="p">:</span>
    <span class="n">sh</span><span class="o">.</span><span class="n">addShard</span><span class="p">(</span> <span class="s2">&quot;rs0/192.168.1.13:27017&quot;</span><span class="p">)</span>
    <span class="n">sh</span><span class="o">.</span><span class="n">addShard</span><span class="p">(</span> <span class="s2">&quot;rs0/192.168.1.44:27017&quot;</span><span class="p">)</span>
    <span class="n">sh</span><span class="o">.</span><span class="n">addShard</span><span class="p">(</span> <span class="s2">&quot;rs0/192.168.1.55:27017&quot;</span><span class="p">)</span>
    <span class="n">sh</span><span class="o">.</span><span class="n">addShard</span><span class="p">(</span> <span class="s2">&quot;rs0/192.168.1.62:27017&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Where 192.168.1.(2,3,4,5) is our CAPE workers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mongo</span>
<span class="n">use</span> <span class="n">cuckoo</span>
<span class="c1"># 5 days, last number is days</span>
<span class="n">db</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">insert</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;tutorials point&quot;</span><span class="p">})</span>
<span class="n">db</span><span class="o">.</span><span class="n">calls</span><span class="o">.</span><span class="n">insert</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;tutorials point&quot;</span><span class="p">})</span>
<span class="n">db</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">createIndex</span> <span class="p">(</span> <span class="p">{</span><span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="s2">&quot;hashed&quot;</span> <span class="p">})</span>
<span class="n">db</span><span class="o">.</span><span class="n">calls</span><span class="o">.</span><span class="n">createIndex</span> <span class="p">(</span> <span class="p">{</span><span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="s2">&quot;hashed&quot;</span><span class="p">})</span>

<span class="n">db</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">createIndex</span> <span class="p">(</span> <span class="p">{</span><span class="s2">&quot;createdAt&quot;</span><span class="p">:</span> <span class="mi">1</span> <span class="p">},</span> <span class="p">{</span><span class="n">expireAfterSeconds</span><span class="p">:</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">5</span><span class="p">}</span> <span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">calls</span><span class="o">.</span><span class="n">createIndex</span> <span class="p">(</span> <span class="p">{</span><span class="s2">&quot;createdAt&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="n">expireAfterSeconds</span><span class="p">:</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">5</span><span class="p">}</span> <span class="p">)</span>

<span class="n">mongosh</span> <span class="o">--</span><span class="n">port</span> <span class="mi">27020</span>
<span class="n">sh</span><span class="o">.</span><span class="n">enableSharding</span><span class="p">(</span><span class="s2">&quot;cuckoo&quot;</span><span class="p">)</span>
<span class="n">sh</span><span class="o">.</span><span class="n">shardCollection</span><span class="p">(</span><span class="s2">&quot;cuckoo.analysis&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="s2">&quot;hashed&quot;</span> <span class="p">})</span>
<span class="n">sh</span><span class="o">.</span><span class="n">shardCollection</span><span class="p">(</span><span class="s2">&quot;cuckoo.calls&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="s2">&quot;hashed&quot;</span> <span class="p">})</span>
</pre></div>
</div>
<p>To see stats on master:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mongos</span> <span class="n">using</span>
<span class="n">mongosh</span> <span class="o">--</span><span class="n">host</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span> <span class="o">--</span><span class="n">port</span> <span class="mi">27020</span>
<span class="n">sh</span><span class="o">.</span><span class="n">status</span><span class="p">()</span>
</pre></div>
</div>
<p>Modify cape reporting.conf [mongodb] to point all mongos in reporting.conf to
host = 127.0.0.1
port = 27020</p>
<p>To remove shard node:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">To</span> <span class="n">see</span> <span class="nb">all</span> <span class="n">shards</span><span class="p">:</span>
<span class="n">db</span><span class="o">.</span><span class="n">adminCommand</span><span class="p">(</span> <span class="p">{</span> <span class="n">listShards</span><span class="p">:</span> <span class="mi">1</span> <span class="p">}</span> <span class="p">)</span>

<span class="n">Then</span><span class="p">:</span>
<span class="n">use</span> <span class="n">admin</span>
<span class="n">db</span><span class="o">.</span><span class="n">runCommand</span><span class="p">(</span> <span class="p">{</span> <span class="n">removeShard</span><span class="p">:</span> <span class="s2">&quot;SHARD_NAME_HERE&quot;</span> <span class="p">}</span> <span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>For more information see:</dt><dd><p><a class="reference external" href="https://docs.mongodb.com/manual/tutorial/remove-shards-from-cluster/">https://docs.mongodb.com/manual/tutorial/remove-shards-from-cluster/</a></p>
</dd>
</dl>
<p>If you need extra help, check this:</p>
<p>See any of these files on your system:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ /etc/uwsgi/apps-available/README
$ /etc/uwsgi/apps-enabled/README
$ /usr/share/doc/uwsgi/README.Debian.gz
$ /etc/default/uwsgi
</pre></div>
</div>
<p>Administration and some useful commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>https://docs.mongodb.com/manual/reference/command/nav-sharding/
$ mongosh --host 127.0.0.1 --port 27020
$ use admin
$ db.adminCommand( { listShards: 1 } )

$ mongosh --host 127.0.0.1 --port 27019
$ db.adminCommand( { movePrimary: &quot;cuckoo&quot;, to: &quot;shard0000&quot; } )
$ db.adminCommand( { removeShard : &quot;shard0002&quot; } )

$ # required for post movePrimary
$ db.adminCommand(&quot;flushRouterConfig&quot;)
$ mongosh --port 27020 --eval &#39;db.adminCommand(&quot;flushRouterConfig&quot;)&#39; admin

$ use cuckoo
$ db.analysis.find({&quot;shard&quot; : &quot;shard0002&quot;},{&quot;shard&quot;:1,&quot;jumbo&quot;:1}).pretty()
$ db.calls.getShardDistribution()

To migrate data ensure:
$ sh.setBalancerState(true)
</pre></div>
</div>
<p>User authentication and roles:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># To create ADMIN</span>
<span class="n">use</span> <span class="n">admin</span>
<span class="n">db</span><span class="o">.</span><span class="n">createUser</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="n">user</span><span class="p">:</span> <span class="s2">&quot;ADMIN_USERNAME&quot;</span><span class="p">,</span>
        <span class="n">pwd</span><span class="p">:</span> <span class="n">passwordPrompt</span><span class="p">(),</span> <span class="o">//</span> <span class="ow">or</span> <span class="n">cleartext</span> <span class="n">password</span>
        <span class="n">roles</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="n">role</span><span class="p">:</span> <span class="s2">&quot;userAdminAnyDatabase&quot;</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="s2">&quot;admin&quot;</span> <span class="p">},</span> <span class="s2">&quot;readWriteAnyDatabase&quot;</span> <span class="p">]</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="c1"># To create user to read/write on specific database</span>
<span class="n">use</span> <span class="n">cuckoo</span>
<span class="n">db</span><span class="o">.</span><span class="n">createUser</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="n">user</span><span class="p">:</span> <span class="s2">&quot;WORKER_USERNAME&quot;</span><span class="p">,</span>
        <span class="n">pwd</span><span class="p">:</span>  <span class="n">passwordPrompt</span><span class="p">(),</span>   <span class="o">//</span> <span class="ow">or</span> <span class="n">cleartext</span> <span class="n">password</span>
        <span class="n">roles</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="n">role</span><span class="p">:</span> <span class="s2">&quot;readWrite&quot;</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="s2">&quot;cuckoo&quot;</span> <span class="p">},</span> <span class="p">{</span> <span class="n">role</span> <span class="p">:</span> <span class="s2">&quot;dbAdmin&quot;</span><span class="p">,</span> <span class="n">db</span> <span class="p">:</span> <span class="s2">&quot;cuckoo&quot;</span>  <span class="p">}]</span>
    <span class="p">}</span>
<span class="p">)</span>


<span class="c1"># To enable auth in ``/etc/mongod.conf``, add next lines</span>
<span class="n">security</span><span class="p">:</span>
    <span class="n">authorization</span><span class="p">:</span> <span class="n">enabled</span>
</pre></div>
</div>
<p>NFS data fetching:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Nice</span> <span class="n">comparision</span> <span class="n">between</span> <span class="n">NFS</span><span class="p">,</span> <span class="n">SSHFS</span><span class="p">,</span> <span class="n">SMB</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">blog</span><span class="o">.</span><span class="n">ja</span><span class="o">-</span><span class="n">ke</span><span class="o">.</span><span class="n">tech</span><span class="o">/</span><span class="mi">2019</span><span class="o">/</span><span class="mi">08</span><span class="o">/</span><span class="mi">27</span><span class="o">/</span><span class="n">nas</span><span class="o">-</span><span class="n">performance</span><span class="o">-</span><span class="n">sshfs</span><span class="o">-</span><span class="n">nfs</span><span class="o">-</span><span class="n">smb</span><span class="o">.</span><span class="n">html</span>
</pre></div>
</div>
<p>To configure NFS on the main server (NFS calls it client)</p>
<blockquote>
<div><dl class="simple">
<dt>Install NFS client:</dt><dd><ul class="simple">
<li><p>sudo apt install nfs-common</p></li>
</ul>
</dd>
<dt>On client create folder per worker:</dt><dd><p>mkdir -p /mnt/cape_worker_&lt;worker_name&gt;</p>
</dd>
<dt>Add workers to fstab:</dt><dd><p>&lt;worker_ip/hostname&gt;:/opt/CAPEv2 /mnt/cape_worker_&lt;worker_name&gt; nfs, auto,users,nofail,noatime,nolock,intr,tcp,actimeo=1800, 0 0</p>
</dd>
<dt>Example:</dt><dd><p>192.168.1.3:/opt/CAPEv2 /mnt/cape_worker_1 nfs, auto,users,nofail,noatime,nolock,intr,tcp,actimeo=1800, 0 0</p>
</dd>
</dl>
</div></blockquote>
<p>CAPE worker(s) (NFS calls it servers):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Install NFS:
    * sudo apt install nfs-kernel-server
    * systemctl enable nfs-kernel-server

Run `id cape`:
    * to get uid and gid to place inside of the file, Example:
        * `uid=997(cape) gid=1005(cape) groups=1005(cape),1002(libvirt),1003(kvm),1004(pcap)`

Add entry to `/etc/exports`
    /opt/CAPEv2 &lt;clinet_ip/hostname&gt;(rw,no_subtree_check,all_squash,anonuid=&lt;uid&gt;,anongid=&lt;gid&gt;)
Example:
    /opt/CAPEv2 192.168.1.1(rw,no_subtree_check,all_squash,anonuid=997,anongid=1005)

Run command on worker:
    exportfs -rav
</pre></div>
</div>
<dl class="simple">
<dt>On CAPE main server run:</dt><dd><p>Run <cite>mount -a</cite> to mount all NFS
Edit <cite>conf/reporting.conf</cite> -&gt; distributed -&gt; nfs=yes</p>
</dd>
</dl>
<p>Online:</p>
<blockquote>
<div><dl class="simple">
<dt>Mongo Auth:</dt><dd><p><a class="reference external" href="https://docs.mongodb.com/manual/tutorial/enable-authentication/">https://docs.mongodb.com/manual/tutorial/enable-authentication/</a></p>
</dd>
<dt>Help about UWSGI:</dt><dd><p><a class="reference external" href="http://vladikk.com/2013/09/12/serving-flask-with-nginx-on-ubuntu/">http://vladikk.com/2013/09/12/serving-flask-with-nginx-on-ubuntu/</a></p>
</dd>
<dt>Help about mongo distributed/sharded:</dt><dd><p><a class="reference external" href="http://dws.la/deploying-a-sharded-cluster-in-mongodb/">http://dws.la/deploying-a-sharded-cluster-in-mongodb/</a>
<a class="reference external" href="https://docs.mongodb.com/manual/tutorial/deploy-replica-set/">https://docs.mongodb.com/manual/tutorial/deploy-replica-set/</a></p>
</dd>
</dl>
</div></blockquote>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/cape.png" alt="Logo"/>
            </a></p>
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Distributed CAPE</a><ul>
<li><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li><a class="reference internal" href="#starting-the-distributed-rest-api">Starting the Distributed REST API</a></li>
<li><a class="reference internal" href="#restful-resources">RESTful resources</a><ul>
<li><a class="reference internal" href="#get-node">GET /node</a></li>
<li><a class="reference internal" href="#post-node">POST /node</a></li>
<li><a class="reference internal" href="#get-node-name">GET /node/&lt;name&gt;</a></li>
<li><a class="reference internal" href="#put-node-name">PUT /node/&lt;name&gt;</a></li>
<li><a class="reference internal" href="#delete-node-name">DELETE /node/&lt;name&gt;</a></li>
</ul>
</li>
<li><a class="reference internal" href="#quick-usage">Quick usage</a></li>
<li><a class="reference internal" href="#proposed-setup">Proposed setup</a><ul>
<li><a class="reference internal" href="#configuration-settings">Configuration settings</a><ul>
<li><a class="reference internal" href="#conf-cuckoo-conf">conf/cuckoo.conf</a></li>
<li><a class="reference internal" href="#conf-processing-conf">conf/processing.conf</a></li>
<li><a class="reference internal" href="#conf-reporting-conf">conf/reporting.conf</a></li>
</ul>
</li>
<li><a class="reference internal" href="#register-cape-nodes">Register CAPE nodes</a></li>
<li><a class="reference internal" href="#vm-maintenance">VM Maintenance</a></li>
<li><a class="reference internal" href="#good-practice-for-production">Good practice for production</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="api.html"
                          title="previous chapter">REST API</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="packages.html"
                          title="next chapter">Analysis Packages</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/usage/dist.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="packages.html" title="Analysis Packages"
             >next</a></li>
        <li class="right" >
          <a href="api.html" title="REST API"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">CAPE Sandbox v2.1 Book</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Usage</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Distributed CAPE</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2010-2015, Cuckoo Foundation, 2016-2020, kevoreilly.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
    </div>
  </body>
</html>